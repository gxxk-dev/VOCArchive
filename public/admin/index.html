<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VOCArchive - 管理后台</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Login Form -->
    <div id="login-container">
        <h2>登录</h2>
        <form id="login-form">
            <input type="password" id="auth-code" placeholder="请输入授权码" required>
            <button type="submit">登录</button>
        </form>
        <p id="login-error" class="error-message"></p>
    </div>

    <!-- Main Admin Panel -->
    <div id="admin-panel" class="hidden">
        <header>
            <h1>管理后台</h1>
            <div class="header-controls">
                <button id="theme-toggle" class="theme-toggle" title="切换深色模式">
                    <i class="fas fa-moon" id="theme-icon"></i>
                </button>
                <button id="logout-button">登出</button>
            </div>
        </header>
        <nav id="tabs">
            <button class="tab-button active" data-target="work">作品 (work)</button>
            <button class="tab-button" data-target="creator">作者 (creator)</button>
            <button class="tab-button" data-target="media">媒体 (Media)</button>
            <button class="tab-button" data-target="asset">资产 (asset)</button>
            <button class="tab-button" data-target="relation">关系 (relation)</button>
            <button class="tab-button" data-target="tag">标签 (tag)</button>
            <button class="tab-button" data-target="category">分类 (category)</button>
            <button class="tab-button" data-target="external_source">存储源 (Storage)</button>
            <button class="tab-button" data-target="external_object">外部对象 (External)</button>
            <button class="tab-button" data-target="footer">页脚 (Footer)</button>
            <button class="tab-button" data-target="site_config">系统配置 (Config)</button>
        </nav>
        <main id="content">
            <!-- Data tables will be loaded here -->
        </main>

        <div id="tool-zone">
            <h2>工具 (Tools)</h2>
            <div class="tool-item">
                <button id="generate-uuid-button">生成 UUID</button>
                <input type="text" id="generated-uuid-result" readonly placeholder="点击按钮生成...">
            </div>
        </div>

        <div id="danger-zone">
            <h2>危险区域</h2>
            <div class="danger-item">
                <p>这些操作可能导致数据丢失，请谨慎操作。</p>
            </div>
            <div class="danger-item">
                <button id="db-init-button" class="danger-button">初始化数据库 (DB Init)</button>
                <small>将创建所有预定义的表。如果表已存在，此操作可能会失败。</small>
            </div>
            <div class="danger-item">
                <button id="db-clear-button" class="danger-button">清空数据库 (DB Clear)</button>
                <small>将删除所有用户数据表。<b>此操作不可逆！</b></small>
            </div>
            <h2>系统配置</h2>
            <div class="danger-item">
                <button id="config-status-button" class="danger-button">检查配置状态 (Config Status)</button>
                <small>检查站点配置表是否存在以及默认配置状态。</small>
                <div id="config-status-result" class="config-status-result"></div>
            </div>
            <div class="danger-item">
                <button id="config-init-button" class="danger-button">初始化配置 (Config Init)</button>
                <small>创建配置表并初始化默认配置。如果配置已存在，此操作将更新缺失的配置项。</small>
                <div id="config-init-result" class="config-init-result"></div>
            </div>
            <h2>外部存储迁移</h2>
            <div class="danger-item">
                <button id="migration-status-button" class="danger-button">检查迁移状态 (Migration Status)</button>
                <small>查看当前外部存储迁移的状态信息。</small>
                <div id="migration-status-result" class="migration-status-result"></div>
            </div>
            <div class="danger-item">
                <label for="asset-url-input">ASSET_URL:</label>
                <input type="text" id="asset-url-input" placeholder="https://assets.example.com" />
                <label for="batch-size-input">批处理大小:</label>
                <input type="number" id="batch-size-input" value="50" min="10" max="500" />
                <br/>
                <button id="execute-migration-button" class="danger-button">执行外部存储迁移 (Execute Migration)</button>
                <small>将现有的assets和media sources迁移到外部存储系统。<b>请确保先备份数据库！</b></small>
            </div>
            <div class="danger-item">
                <button id="validate-migration-button" class="danger-button">验证迁移完整性 (Validate Migration)</button>
                <small>检查迁移的完整性和数据一致性。</small>
                <div id="validation-result" class="validation-result"></div>
            </div>
        </div>
    </div>

    <!-- Create/Edit Modal -->
    <div id="form-modal" class="modal hidden">
        <div class="modal-content">
            <span class="close-button">&times;</span>
            <h2 id="form-title"></h2>
            <form id="modal-form">
                <!-- Form fields will be dynamically inserted here -->
            </form>
            <p id="form-error" class="error-message"></p>
        </div>
    </div>

    <script src="md3-select.js"></script>
    <script src="script.js"></script>
</body>
</html>
